define("torii/adapters/application",["exports"],function(a){"use strict";var b=Ember.Object.extend({open:function(){return new Ember.RSVP.Promise(function(){throw new Error("The Torii adapter must implement `open` for a session to be opened")})},fetch:function(){return new Ember.RSVP.Promise(function(){throw new Error("The Torii adapter must implement `fetch` for a session to be fetched")})},close:function(){return new Ember.RSVP.Promise(function(){throw new Error("The Torii adapter must implement `close` for a session to be closed")})}});a["default"]=b}),define("torii/bootstrap/session",["torii/session","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=function(a,b){return a.register("torii:session",c),a.injection("torii:session","torii","torii:main"),a.injection("route",b,"torii:session"),a.injection("controller",b,"torii:session"),a}}),define("torii/bootstrap/torii",["torii/torii","torii/providers/linked-in-oauth2","torii/providers/google-oauth2","torii/providers/facebook-connect","torii/providers/facebook-oauth2","torii/adapters/application","torii/providers/twitter-oauth1","torii/providers/github-oauth2","torii/services/popup","exports"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=a["default"],l=b["default"],m=c["default"],n=d["default"],o=e["default"],p=f["default"],q=g["default"],r=h["default"],s=i["default"];j["default"]=function(a){return a.register("torii:main",k),a.register("torii-provider:linked-in-oauth2",l),a.register("torii-provider:google-oauth2",m),a.register("torii-provider:facebook-connect",n),a.register("torii-provider:facebook-oauth2",o),a.register("torii-provider:twitter",q),a.register("torii-provider:github-oauth2",r),a.register("torii-adapter:application",p),a.register("torii-service:popup",s),a.injection("torii-provider","popup","torii-service:popup"),window.DS&&(a.injection("torii-provider","store","store:main"),a.injection("torii-adapter","store","store:main")),a}}),define("torii/configuration",["exports"],function(a){"use strict";function b(a,b){return Ember.computed(function(){var e=this.get("configNamespace"),f=e?[e,a].join("."):a,g=c(d,f);if("undefined"==typeof g){if("undefined"!=typeof b)return"function"==typeof b?b.call(this):b;throw new Error("Expected configuration value "+f+" to be defined!")}return g})}var c=Ember.get,d=c(window,"ENV.torii")||{};d.providers=d.providers||{},a.configurable=b,a["default"]=d}),define("torii/initializers/initialize-torii-callback",["torii/redirect-handler","exports"],function(a,b){"use strict";var c=a["default"];b["default"]={name:"torii-callback",before:"torii",initialize:function(a,b){b.deferReadiness(),c.handle(window.location.toString()).catch(function(){b.advanceReadiness()})}}}),define("torii/initializers/initialize-torii-session",["torii/configuration","torii/bootstrap/session","exports"],function(a,b,c){"use strict";var d=a["default"],e=b["default"];c["default"]={name:"torii-session",after:"torii",initialize:function(a){d.sessionServiceName&&(e(a,d.sessionServiceName),a.injection("adapter",d.sessionServiceName,"torii:session"))}}}),define("torii/initializers/initialize-torii",["torii/bootstrap/torii","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b["default"],f={name:"torii",initialize:function(a,b){d(a);for(var c in e.providers)e.providers.hasOwnProperty(c)&&a.lookup("torii-provider:"+c);b.inject("route","torii","torii:main")}};window.DS&&(f.after="store"),c["default"]=f}),define("torii/lib/load-initializer",["exports"],function(a){"use strict";a["default"]=function(a){Ember.onLoad("Ember.Application",function(b){b.initializer(a)})}}),define("torii/lib/parse-query-string",["exports"],function(a){"use strict";a["default"]=Ember.Object.extend({init:function(a,b){this.url=a,this.validKeys=b},parse:function(){for(var a=this.url,b=this.validKeys,c={},d=0;d<b.length;d++){var e=b[d],f=new RegExp(e+"=([^&#]*)"),g=f.exec(a);g&&(c[e]=g[1])}return c}})}),define("torii/lib/query-string",["exports"],function(a){"use strict";function b(a){return a||a===!1}function c(a,c,d){var g=e(c),h=f(a,g);if(!d){if(!b(h)&&b(f(a,c)))throw new Error('Use camelized versions of url params. (Did not find "'+g+'" property but did find "'+c+'".');if(!b(h))throw new Error('Missing url param: "'+c+'". (Looked for: property named "'+g+'".')}return b(h)?encodeURIComponent(h):void 0}function d(a,b){return c(a,b,!0)}var e=Ember.String.camelize,f=Ember.get;a["default"]=Ember.Object.extend({init:function(a,b,c){this.obj=a,this.urlParams=Ember.A(b),this.optionalUrlParams=Ember.A(c||[])},toString:function(){var a=this.urlParams,e=this.optionalUrlParams,f=this.obj,g=Ember.A([]);return a.forEach(function(a){var b=c(f,a);g.push([a,b])}),e.forEach(function(a){var c=d(f,a);b(c)&&g.push([a,c])}),g.map(function(a){return a.join("=")}).join("&")}})}),define("torii/lib/required-property",["exports"],function(a){"use strict";function b(){return Ember.computed(function(a){throw new Error("Definition of property "+a+" by a subclass is required.")})}a["default"]=b}),define("torii/lib/state-machine",["exports"],function(a){"use strict";function b(a){return a.constructor===Array?a:a?[a]:[]}function c(a){var b=a.initialState;if(this.states=a.states,!this.states)throw new Error("StateMachine needs states");if(this.state=this.states[b],!this.state)throw new Error("Missing initial state");this.currentStateName=b,this._subscriptions={};var c,d,e,f=a.beforeTransitions||[],g=a.afterTransitions||[];for(d=0,e=f.length;e>d;d++)c=f[d],this.beforeTransition.call(this,c,c.fn);for(d=0,e=g.length;e>d;d++)c=g[d],this.afterTransition.call(this,c,c.fn)}function d(a,b,c){var d;if(!b)throw new Error("invalid Transition");if(c){var f=b,g=c;d=e(f,g)}else{if(b.constructor!==Object)throw new Error("something went wrong");d=b}return d}function e(a,c){return b(a).reduce(function(a,b){return a[b]=c,a},{})}function f(a,b,c,d,e){var f=a[c];if(!(c&&d&&f)){var g="invalid transition state: "+(f&&f.currentStateName)+" from: "+c+" to: "+d;throw new Error(g)}a[c][b]=e}var g=Array.prototype.slice,h=Ember.keys,i=c.SPLAT="*";c.transitionTo=function(a){return function(){this.transitionTo(a)}},c.prototype={states:{},toString:function(){return"<StateMachine currentState:'"+this.currentStateName+"' >"},transitionTo:function(a){if("."===a.charAt(0)){var b=this.currentStateName.split(".").slice(0,-1);a=0<b.length?b.join(".")+a:a.substring(1)}var c=this.states[a],d=this.currentStateName;if(!c)throw new Error("Unknown State: `"+a+"`");this.willTransition(d,a),this.state=c,this.currentStateName=a,this.didTransition(d,a)},beforeTransition:function(a,b){this._transition("willTransition",a,b)},afterTransition:function(a,b){this._transition("didTransition",a,b)},_transition:function(a,b,c){var d,e,f,g,h,j,k=b.from||i,l=b.to||i;0===l.indexOf("!")?(d=l.substr(1),h=!0):(d=l,h=!1),0===k.indexOf("!")?(e=k.substr(1),j=!0):(e=k,j=!1),g=e.indexOf(i),f=d.indexOf(i),g>=0&&(e=e.substring(g,0)),f>=0&&(d=d.substring(f,0)),this.on(a,function(a,b){var i,k,l=b,m=a;g>=0&&(m=a.substring(g,0)),f>=0&&(l=b.substring(f,0)),i=l===d!==h,k=m===e!==j,i&&k&&c.call(this,a,b)})},willTransition:function(a,b){this._notify("willTransition",a,b)},didTransition:function(a,b){this._notify("didTransition",a,b)},_notify:function(a,b,c){for(var d=this._subscriptions[a]||[],e=0,f=d.length;f>e;e++)d[e].call(this,b,c)},on:function(a,b){this._subscriptions[a]=this._subscriptions[a]||[],this._subscriptions[a].push(b)},off:function(a,b){var c=this._subscriptions[a].indexOf(b);b?c&&this._subscriptions[a].splice(c,1):this._subscriptions[a]=null},send:function(a){var b=this.state[a],c=g.call(arguments,1);return b?b.apply(this,c):void this.unhandledEvent(a)},trySend:function(a){var b=this.state[a],c=g.call(arguments,1);return b?b.apply(this,c):void 0},event:function(a,b){var e=this.states,g={transition:function(){var b=(arguments.length,arguments[0]),g=arguments[1],i=d(a,b,g);h(i).forEach(function(b){var d=i[b];f(e,a,b,d,c.transitionTo(d))})}};b.call(g)},unhandledEvent:function(a){var b=(this.currentStateName,"Unknown Event: `"+a+"` for: "+this.toString());throw new Error(b)}},a["default"]=c}),define("torii/load-initializers",["torii/lib/load-initializer","torii/initializers/initialize-torii","torii/initializers/initialize-torii-callback","torii/initializers/initialize-torii-session","exports"],function(a,b,c,d,e){"use strict";var f=a["default"],g=b["default"],h=c["default"],i=d["default"];e["default"]=function(){f(h),f(g),f(i)}}),define("torii/providers/base",["torii/lib/required-property","exports"],function(a,b){"use strict";var c=a["default"],d=Ember.Object.extend({name:c(),configNamespace:function(){return"providers."+this.get("name")}.property("name")});b["default"]=d}),define("torii/providers/facebook-connect",["torii/providers/base","torii/configuration","exports"],function(a,b,c){"use strict";function d(a){if(g)return g;var b=window.fbAsyncInit;return g=new Ember.RSVP.Promise(function(b){window.fbAsyncInit=function(){FB.init(a),Ember.run(null,b)},$.getScript("//connect.facebook.net/en_US/all.js")}).then(function(){window.fbAsyncInit=b})}function e(){return new Ember.RSVP.Promise(function(a,b){FB.login(function(c){c.authResponse?Ember.run(null,a,c.authResponse):Ember.run(null,b,c.status)})})}function f(a){return{userId:a.userID,accessToken:a.accessToken}}var g,h=a["default"],i=b.configurable,j=h.extend({name:"facebook-connect",scope:i("scope","email"),appId:i("appId"),open:function(){return d(this.settings()).then(e).then(f)},settings:function(){return{status:!0,cookie:!0,xfbml:!1,appId:this.get("appId")}},loadFbLogin:function(){d(this.settings())}.on("init")});c["default"]=j}),define("torii/providers/facebook-oauth2",["torii/configuration","torii/providers/oauth2-code","exports"],function(a,b,c){"use strict";var d=a.configurable,e=b["default"];c["default"]=e.extend({name:"facebook-oauth2",baseUrl:"https://www.facebook.com/dialog/oauth",requiredUrlParams:["display"],scope:d("scope","email"),display:"popup",redirectUri:d("redirectUri",function(){return this._super()})})}),define("torii/providers/github-oauth2",["torii/providers/oauth2-code","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable,f=d.extend({name:"github-oauth2",baseUrl:"https://github.com/login/oauth/authorize",requiredUrlParams:["state"],state:"STATE",redirectUri:e("redirectUri",function(){return this._super()})});c["default"]=f}),define("torii/providers/google-oauth2",["torii/providers/oauth2-code","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable,f=d.extend({name:"google-oauth2",baseUrl:"https://accounts.google.com/o/oauth2/auth",requiredUrlParams:["state"],optionalUrlParams:["scope","request_visible_actions"],request_visible_actions:e("requestVisibleActions",""),scope:e("scope","email"),state:e("state","STATE"),redirectUri:e("redirectUri","http://localhost:8000/oauth2callback")});c["default"]=f}),define("torii/providers/linked-in-oauth2",["torii/providers/oauth2-code","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable,f=d.extend({name:"linked-in-oauth2",baseUrl:"https://www.linkedin.com/uas/oauth2/authorization",requiredUrlParams:["state"],state:"STATE",redirectUri:e("redirectUri",function(){return this._super()})});c["default"]=f}),define("torii/providers/oauth1",["torii/providers/base","torii/configuration","torii/lib/query-string","torii/lib/required-property","exports"],function(a,b,c,d,e){"use strict";var f=a["default"],g=b.configurable,h=(c["default"],d["default"],f.extend({name:"oauth1",requestTokenUri:g("requestTokenUri"),buildRequestTokenUrl:function(){var a=this.get("requestTokenUri");return a},open:function(){var a=this.get("name"),b=this.buildRequestTokenUrl();return this.get("popup").open(b,["code"]).then(function(b){return b.provider=a,b})}}));e["default"]=h}),define("torii/providers/oauth2-code",["torii/providers/base","torii/configuration","torii/lib/query-string","torii/lib/required-property","exports"],function(a,b,c,d,e){"use strict";function f(){return[window.location.protocol,"//",window.location.host,window.location.pathname].join("")}var g=a["default"],h=b.configurable,i=c["default"],j=d["default"],k=["code","access_token","expires_in"],l=g.extend({concatenatedProperties:["requiredUrlParams","optionalUrlParams"],requiredUrlParams:["response_type","client_id","redirect_uri"],optionalUrlParams:["scope"],baseUrl:j(),apiKey:h("apiKey"),scope:h("scope",null),clientId:Ember.computed.alias("apiKey"),responseType:"code",redirectUri:function(){return f()}.property(),buildQueryString:function(){var a=this.get("requiredUrlParams"),b=this.get("optionalUrlParams"),c=new i(this,a,b);return c.toString()},buildUrl:function(){var a=this.get("baseUrl"),b=this.buildQueryString();return[a,b].join("?")},open:function(){var a=this.get("name"),b=this.buildUrl(),c=this.get("redirectUri");return this.get("popup").open(b,k).then(function(b){return{authorizationCode:b.code,provider:a,redirectUri:c}})}});e["default"]=l}),define("torii/providers/twitter-oauth1",["torii/providers/oauth1","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=c.extend({name:"twitter"})}),define("torii/redirect-handler",["exports"],function(a){"use strict";var b=Ember.Object.extend({init:function(a){this.url=a},run:function(){var a=this.url;return new Ember.RSVP.Promise(function(b,c){if(window.opener){var d="__torii_message:"+a;window.opener.postMessage(d,"*")}else c("No window.opener")})}});b.reopenClass({handle:function(a){var c=new b(a);return c.run()}}),a["default"]=b}),define("torii/services/popup",["torii/lib/parse-query-string","exports"],function(a,b){"use strict";function c(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var d;switch(a[c]){case!0:d="1";break;case!1:d="0";break;default:d=a[c]}b.push(c+"="+d)}return b.join(",")}function d(a){var b=a.width||500,c=a.height||500;return Ember.$.extend({left:screen.width/2-b/2,top:screen.height/2-c/2,width:b,height:c},a)}function e(a){return a&&0===a.indexOf(h)}function f(a,b){var c=a.slice(h.length),d=new g(c,b),e=d.parse();return e}var g=a["default"],h="__torii_message:",i=Ember.Object.extend(Ember.Evented,{open:function(a,b,g){var h=this,i=this.popup;return new Ember.RSVP.Promise(function(j,k){i&&h.close();var l=c(d(g||{}));return h.popup=window.open(a,"torii-auth",l),!h.popup||h.popup.closed?void k(new Error("Popup could not open or was closed")):(h.popup.focus(),h.one("didClose",function(){k(new Error("Popup was closed or authorization was denied"))}),Ember.$(window).on("message.torii",function(a){var c=a.originalEvent.data;if(e(c)){var d=f(c,b);j(d)}}),void h.schedulePolling())}).finally(function(){h.close(),Ember.$(window).off("message.torii")})},close:function(){this.popup&&(this.popup.close(),this.popup=null,this.trigger("didClose"))},pollPopup:function(){this.popup&&this.popup.closed&&this.trigger("didClose")},schedulePolling:function(){this.polling=Ember.run.later(this,function(){this.pollPopup(),this.schedulePolling()},35)},stopPolling:function(){Ember.run.cancel(this.polling)}.on("didClose")});b["default"]=i}),define("torii/session",["torii/session/state-machine","exports"],function(a,b){"use strict";function c(a,b){var c=a.lookup("torii-adapter:"+b);return c||(c=a.lookup("torii-adapter:application")),c}var d=a["default"],e=Ember.ObjectProxy.extend({state:null,stateMachine:function(){return d(this)}.property(),setupStateProxy:function(){var a=this.get("stateMachine"),b=this;a.on("didTransition",function(){b.set("content",a.state),b.set("currentStateName",a.currentStateName)})}.on("init"),setUnknownProperty:Ember.K,open:function(a,b){var d=this.container,e=this.get("torii"),f=this.get("stateMachine");return new Ember.RSVP.Promise(function(a){f.send("startOpen"),a()}).then(function(){return e.open(a,b)}).then(function(b){var e=c(d,a);return e.open(b)}).then(function(a){return f.send("finishOpen",a),a}).catch(function(a){return f.send("failOpen",a),Ember.RSVP.reject(a)})},fetch:function(a){var b=this.container,d=this.get("stateMachine");return new Ember.RSVP.Promise(function(a){d.send("startFetch"),a()}).then(function(){var d=c(b,a);return d.fetch()}).then(function(a){d.send("finishFetch",a)}).catch(function(a){return d.send("failFetch",a),Ember.RSVP.reject(a)})},close:function(){var a=this.container,b=this.get("stateMachine");return new Ember.RSVP.Promise(function(a){b.send("startClose"),a()}).then(function(){var b=c(a);return b.close()}).then(function(){b.send("finishClose")}).catch(function(a){return b.send("failClose",a),Ember.RSVP.reject(a)})}});b["default"]=e}),define("torii/session/state-machine",["torii/lib/state-machine","exports"],function(a,b){"use strict";function c(a,b){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}function d(a,b){return function(){for(var c;c<b.length;c++)this[b[c]]=null;this.transitionTo(a)}}var e=a["default"],f=e.transitionTo;b["default"]=function(a){var b=new e({initialState:"unauthenticated",states:{unauthenticated:{errorMessage:null,isAuthenticated:!1,startOpen:d("opening",["errorMessage"]),startFetch:d("fetching",["errorMessage"])},authenticated:{currentUser:null,isAuthenticated:!0,startClose:f("closing")},opening:{isWorking:!0,isOpening:!0,finishOpen:function(a){c(a,this.states.authenticated),this.transitionTo("authenticated")},failOpen:function(a){this.states.unauthenticated.errorMessage=a,this.transitionTo("unauthenticated")}},fetching:{isWorking:!0,isFetching:!0,finishFetch:function(a){c(a,this.states.authenticated),this.transitionTo("authenticated")},failFetch:function(a){this.states.unauthenticated.errorMessage=a,this.transitionTo("unauthenticated")}},closing:{isWorking:!0,isClosing:!0,isAuthenticated:!0,finishClose:function(){this.transitionTo("unauthenticated")},failClose:function(a){this.states.unauthenticated.errorMessage=a,this.transitionTo("unauthenticated")}}}});return b.session=a,b}}),define("torii/torii",["exports"],function(a){"use strict";function b(a,b){return a.lookup("torii-provider:"+b)}function c(a,c){return function(d,e){var f=this.container,g=b(f,d);if(!g)throw new Error("Expected a provider named '"+d+"' , did you forget to register it?");if(!g[a]){if(c)throw new Error("Expected provider '"+d+"' to define the '"+a+"' method.");return Ember.RSVP.Promise.resolve({})}return new Ember.RSVP.Promise(function(b){b(g[a](e))})}}var d=Ember.Object.extend({open:c("open",!0),fetch:c("fetch"),close:c("close")});a["default"]=d});